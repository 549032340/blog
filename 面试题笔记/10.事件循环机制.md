### 事件循环的宏观描述

js引擎遇到一个异步事件后并不会一直等待其返回结果，而是会将这个事件挂起，继续执行执行栈中的其他任务。当一个异步事件返回结果后，js会将这个事件加入与当前执行栈不同的另一个队列，称之为**事件队列（Task Queue）**。被放入事件队列不会立即执行其回调，而是等待当**前执行栈中的所有任务都执行完毕**，**主线程处于闲置状态时**，主线程会去查找事件队列中是否有任务。如果有，那么主线程会从中取出排在第一位的事件，并且把这个事件对应的回调放到执行栈中，然后执行其中的同步代码，如此反复，这样就形成了无限的循环。这就是这个过程被称之为**事件循环（Event Loop）**的原因

### 事件循环的微观描述

##### 异步事件存在宏任务（macro task）和微任务（micro task）的区分，微任务优先于宏任务

所谓的微观描述，其实就是上面宏观描述的一个补充：事件队列其实有两个：**宏任务队列和微任务队列**。

主线程处于闲置状态时，会优先去查看微任务队列，如果有事件存在，则取出第一个扔入执行栈中并执行其同步代码，然后继续查看微任务队列，直到微任务队列为空之后再去查看宏任务队列，然后循环执行。

> 当前执行栈执行完毕时会立刻先处理所有微任务队列中的事件，然后再去宏任务队列中取出一个事件。同一次事件循环中，微任务永远在宏任务之前执行。



